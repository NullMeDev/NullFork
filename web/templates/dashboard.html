<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Gateway Scraper GUI</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1>Enhanced Gateway Scraper Dashboard</h1>
        <div id="status" class="my-4">
            <h3>Status: <span class="badge bg-success">Online</span></h3>
        </div>
        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <button id="startScan" class="btn btn-primary me-md-2" type="button">Start Scan</button>
            <button id="stopScan" class="btn btn-secondary" type="button">Stop Scan</button>
        </div>
        <div class="my-4">
            <h4>Recent Activity</h4>
            <ul id="activity-log" class="list-group">
                <!-- Logs will be inserted here -->
            </ul>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // Fetch status from the API
            function updateStatus() {
                fetch('/api/v1/health')
                    .then(response => response.json())
                    .then(data => {
                        $('#status span').text(data.status === 'healthy' ? 'Online' : 'Offline');
                    });
            }

            // Log recent activity
            function logActivity(message) {
                const log = $('<li>').addClass('list-group-item').text(message);
                $('#activity-log').prepend(log);
            }

            // Event handlers for scan buttons
            $('#startScan').click(function() {
                fetch('/api/v1/check/start', { method: 'POST' })
                    .then(() => logActivity('Scan started.'));
            });

            $('#stopScan').click(function() {
                fetch('/api/v1/check/stop', { method: 'POST' })
                    .then(() => logActivity('Scan stopped.'));
            });

            // Simulate activity for demo purposes
            setInterval(() => {
                logActivity('Sample log entry ' + new Date().toLocaleTimeString());
            }, 5000);

            // Initial status update
            updateStatus();
        });
    </script>
</body>
</html>
